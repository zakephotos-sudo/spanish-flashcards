let words = [];
let filtered = [];
let current = 0;
let flipped = false;
let selectedCategory = "";

fetch("words.json")
.then(r=>r.json())
.then(data=>{
  words = data;
});

function selectCategory(cat){
  selectedCategory = cat;
  filtered = words.filter(w => w.category === cat);
  shuffle();

  document.getElementById("menu").classList.add("hidden");
  document.getElementById("study").classList.remove("hidden");
}

function updateCard(){
  if(!filtered.length){
    document.getElementById("card").textContent = "No words found.";
    return;
  }

  const word = filtered[current];
  document.getElementById("card").textContent =
    flipped ? word.en : word.es;

  document.getElementById("counter").textContent =
    (current + 1) + " / " + filtered.length;
}

function flipCard(){
  flipped = !flipped;
  updateCard();
}

function nextCard(){
  current = (current + 1) % filtered.length;
  flipped = false;
  updateCard();
}

function prevCard(){
  current = (current - 1 + filtered.length) % filtered.length;
  flipped = false;
  updateCard();
}

function shuffle(){
  for (let i = filtered.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [filtered[i], filtered[j]] = [filtered[j], filtered[i]];
  }
  current = 0;
  flipped = false;
  updateCard();
}

function exitStudy(){
  document.getElementById("study").classList.add("hidden");
  document.getElementById("menu").classList.remove("hidden");
}